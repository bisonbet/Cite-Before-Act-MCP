# =============================================================================
# Cite-Before-Act MCP - Environment Configuration
# =============================================================================
# Copy this file to .env and edit as desired
# cp .env.example .env
#
# Note: Local approval works out of the box! You only need to configure
# environment variables if you want to customize behavior or use Slack.
# =============================================================================

# -----------------------------------------------------------------------------
# Slack Configuration (OPTIONAL)
# -----------------------------------------------------------------------------
# Local approval works by default with GUI popups. Only configure Slack if you
# want team-wide approval workflows via Slack channels.

# Slack Bot Token (required if using Slack)
# Get this from: https://api.slack.com/apps -> Your App -> OAuth & Permissions
# Token format: xoxb-xxxxxxxxxxxx-xxxxxxxxxxxxxxxxxxxxxxxx
# SLACK_BOT_TOKEN=xoxb-your-token-here

# Slack Channel (optional)
# For PUBLIC channels: Use channel name with # (e.g., #approvals) or channel ID (C1234567890)
# For PRIVATE channels: Use channel name WITHOUT # (e.g., approvals) or group ID (G1234567890)
# Note: Bot must be invited to private channels: /invite @YourBotName
# If not set, SLACK_USER_ID must be set for direct messages
# SLACK_CHANNEL=approvals  # Private channel (no #)
# SLACK_CHANNEL=#approvals  # Public channel (with #)

# Slack User ID (optional)
# User ID for sending direct messages instead of channel messages
# Format: U1234567890
# SLACK_USER_ID=U1234567890

# -----------------------------------------------------------------------------
# Detection Configuration (OPTIONAL)
# -----------------------------------------------------------------------------
# Configure how the system detects mutating vs non-mutating tool calls.
# Defaults work well for most cases, but you can customize for your needs.

# Allowlist: Comma-separated list of tool names that ALWAYS require approval
# These tools will always be treated as mutating, regardless of other detection
# Example: write_file,delete_file,send_email,charge_card
# DETECTION_ALLOWLIST=write_file,edit_file,create_directory,move_file,delete_file

# Blocklist: Comma-separated list of tool names that NEVER require approval
# These tools will always pass through without approval
# Example: read_file,list_directory,get_info
# DETECTION_BLOCKLIST=read_text_file,read_media_file,list_directory,get_file_info

# Enable Convention-Based Detection (default: true)
# If true, tools with names starting with "write_", "delete_", "send_", etc.
# will be automatically detected as mutating
# DETECTION_ENABLE_CONVENTION=true

# Enable Metadata-Based Detection (default: true)
# If true, analyzes tool descriptions and metadata to detect mutating operations
# DETECTION_ENABLE_METADATA=true

# -----------------------------------------------------------------------------
# Upstream Server Configuration (REQUIRED for proxy mode)
# -----------------------------------------------------------------------------
# Configure the MCP server that Cite-Before-Act will proxy and wrap with
# approval requirements.

# Upstream Command (required for stdio transport)
# Command to run the upstream MCP server
# Example: npx, python, node
# UPSTREAM_COMMAND=npx

# Upstream Arguments (required for stdio transport)
# Comma-separated list of arguments for the upstream server command
# Example for filesystem server: -y,@modelcontextprotocol/server-filesystem,/path/to/directory
# Note: Use absolute paths, not ~ or relative paths
# UPSTREAM_ARGS=-y,@modelcontextprotocol/server-filesystem,/Users/yourname/mcp-test-workspace

# Upstream URL (required for http/sse transport)
# Full URL to the upstream MCP server
# Example: http://localhost:3010
# UPSTREAM_URL=http://localhost:3010

# Upstream Transport (default: stdio)
# Transport type: stdio, http, or sse
# - stdio: Communicate via standard input/output (most common)
# - http: HTTP-based communication
# - sse: Server-Sent Events
# UPSTREAM_TRANSPORT=stdio

# -----------------------------------------------------------------------------
# Approval Settings
# -----------------------------------------------------------------------------

# Approval Timeout (default: 300 seconds = 5 minutes)
# How long to wait for approval before automatically rejecting
# Set to 0 for no timeout (wait indefinitely)
# APPROVAL_TIMEOUT_SECONDS=300

# Enable Slack Integration (default: true)
# If true, attempts to use Slack for approvals (requires SLACK_BOT_TOKEN)
# If false or if Slack fails, falls back to local approval
# ENABLE_SLACK=true

# Use Local Approval (default: true)
# If true, enables local approval (GUI popup or file-based)
# Local approval is always used as fallback even if Slack is configured
# Set to false to disable local approval (Slack only)
# USE_LOCAL_APPROVAL=true

# Use Native Dialog (default: true)
# If true, uses native OS dialogs for local approval:
#   - macOS: Uses osascript (AppleScript) - works even in stdio MCP mode
#   - Windows: Uses PowerShell MessageBox - works even in stdio MCP mode
#   - Linux: File-based approval only (no native dialog available)
# If false, uses file-based approval only (writes to /tmp/cite-before-act-approval-*.json)
# Note: File-based approval instructions are ALWAYS shown in logs, regardless of this setting
# USE_NATIVE_DIALOG=true

# =============================================================================
# Quick Start Examples
# =============================================================================

# Minimal Configuration (Local Approval Only):
# - No variables needed! Works out of the box with GUI popups.

# With Slack (Works in Parallel with Local Approval):
# SLACK_BOT_TOKEN=xoxb-your-token-here
# SLACK_CHANNEL=#approvals
# USE_LOCAL_APPROVAL=true
# USE_NATIVE_DIALOG=true

# Filesystem Server Example:
# UPSTREAM_COMMAND=npx
# UPSTREAM_ARGS=-y,@modelcontextprotocol/server-filesystem,/Users/yourname/mcp-test-workspace
# UPSTREAM_TRANSPORT=stdio

# =============================================================================
